{% extends "base.html" %}

{% block title %}Inkwell — A place for your thoughts{% endblock %}

{% block extra_styles %}
.page-wrap {
  max-width: 760px;
  margin: 3rem auto;
  padding: 0 1.5rem;
}

/* ── Hero (unauthenticated) ─────────────────────────────── */
.hero {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  min-height: calc(100vh - 56px);
  padding: 3rem 1.5rem;
  gap: 1.5rem;
}
.hero-eyebrow {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.78rem;
  font-weight: 500;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--red);
  border: 1px solid rgba(220, 38, 38, 0.3);
  background: var(--red-dim);
  padding: 0.3rem 0.8rem;
  border-radius: 999px;
}
.hero h1 {
  font-size: clamp(2.2rem, 6vw, 3.8rem);
  font-weight: 700;
  letter-spacing: -0.04em;
  line-height: 1.1;
  max-width: 700px;
}
.hero h1 span { color: var(--red); }
.hero p {
  font-size: 1.05rem;
  color: var(--text-muted);
  max-width: 480px;
  line-height: 1.7;
}
.hero-actions {
  display: flex;
  gap: 0.75rem;
  flex-wrap: wrap;
  justify-content: center;
  margin-top: 0.5rem;
}
.hero-actions .btn { padding: 0.7rem 1.8rem; font-size: 0.95rem; }

/* ── Feed header ────────────────────────────────────────── */
.feed-header {
  margin-bottom: 2rem;
}
.feed-header h1 {
  font-size: 1.75rem;
  font-weight: 700;
  letter-spacing: -0.03em;
}
.post-count {
  font-size: 0.8rem;
  color: var(--text-muted);
  font-weight: 400;
  margin-left: 0.6rem;
}

/* ── Post list ──────────────────────────────────────────── */
.post-list {
  display: flex;
  flex-direction: column;
  gap: 1px;
  border: 1px solid var(--border);
  border-radius: 10px;
  overflow: hidden;
}
.post-card {
  background: var(--surface);
  padding: 1.25rem 1.5rem;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  transition: background 0.12s;
  border-bottom: 1px solid var(--border);
}
.post-card:last-child { border-bottom: none; }
.post-card:hover { background: var(--surface-2); }

.post-card-top {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 1rem;
}
.post-title {
  font-size: 1.05rem;
  font-weight: 600;
  letter-spacing: -0.02em;
  color: var(--text);
  line-height: 1.35;
  text-decoration: none;
}
.post-title:hover { color: var(--red); text-decoration: none; }

.post-excerpt {
  font-size: 0.875rem;
  color: var(--text-muted);
  line-height: 1.6;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.post-card-meta {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  flex-wrap: wrap;
  margin-top: 0.15rem;
}
.meta-item {
  font-size: 0.78rem;
  color: var(--text-muted);
}
.meta-dot {
  width: 3px;
  height: 3px;
  border-radius: 50%;
  background: var(--border);
}
.tag-pill {
  display: inline-flex;
  align-items: center;
  padding: 0.15rem 0.55rem;
  background: var(--red-dim);
  border: 1px solid rgba(220, 38, 38, 0.2);
  border-radius: 999px;
  font-size: 0.72rem;
  color: var(--red);
  font-weight: 500;
}

/* ── Empty feed ─────────────────────────────────────────── */
.feed-empty {
  text-align: center;
  padding: 5rem 0;
  color: var(--text-muted);
  font-size: 0.95rem;
}
{% endblock %}

{% block content %}
{% if user.is_authenticated %}
  <div class="page-wrap">
    <div class="feed-header">
      <h1>
        All posts
        {% if posts %}<span class="post-count">{{ posts|length }} post{{ posts|length|pluralize }}</span>{% endif %}
      </h1>
    </div>

    {% if posts %}
      <div class="post-list">
        {% for post in posts %}
          <div class="post-card">
            <div class="post-card-top">
              <a href="{% url 'blog:post-detail' post.slug %}" class="post-title">{{ post.title }}</a>
            </div>
            {% if post.excerpt %}
              <p class="post-excerpt">{{ post.excerpt }}</p>
            {% elif post.content %}
              <p class="post-excerpt">{{ post.content|truncatechars:160 }}</p>
            {% endif %}
            <div class="post-card-meta">
              <span class="meta-item">{{ post.author.username }}</span>
              <span class="meta-dot"></span>
              <span class="meta-item">{{ post.created_at|date:"M j, Y" }}</span>
              {% if post.tags.exists %}
                <span class="meta-dot"></span>
                {% for tag in post.tags.all %}
                  <span class="tag-pill">{{ tag.name }}</span>
                {% endfor %}
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="feed-empty">No published posts yet. <a href="{% url 'blog:post-create' %}">Be the first to write one.</a></p>
    {% endif %}
  </div>

{% else %}
  <div class="hero">
    <span class="hero-eyebrow">&#9679; Open platform · Public API</span>
    <h1>Write, share, and <span>connect</span></h1>
    <p>Inkwell is a simple blogging platform for people who love words. No noise, just writing.</p>
    <div class="hero-actions">
      <a href="{% url 'user:register' %}" class="btn">Start writing</a>
      <a href="{% url 'login' %}" class="btn btn-outline">Sign in</a>
    </div>
  </div>
{% endif %}
{% endblock %}
